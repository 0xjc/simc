action_priority_list_t* precombat = get_action_priority_list( "precombat" );
action_priority_list_t* def = get_action_priority_list( "default" );
action_priority_list_t* st = get_action_priority_list( "st" );
action_priority_list_t* aoe = get_action_priority_list( "aoe" );
action_priority_list_t* fallthru = get_action_priority_list( "fallthru" );

precombat->add_action( "variable,name=on_use_trinket,value=0" );
precombat->add_action( "variable,name=on_use_trinket,op=add,value=trinket.1.has_proc.any&trinket.1.cooldown.duration" );
precombat->add_action( "variable,name=on_use_trinket,op=add,value=(trinket.2.has_proc.any&trinket.2.cooldown.duration)*2" );
precombat->add_action( "moonkin_form" );
precombat->add_action( "wrath" );
precombat->add_action( "wrath" );

def->add_action( "variable,name=is_aoe,value=spell_targets.starfall>1&(!talent.starlord.enabled|talent.stellar_drift.enabled)|spell_targets.starfall>2" );
def->add_action( "variable,name=is_cleave,value=spell_targets.starfire>1" );
def->add_action( "variable,name=passive_asp,value=6+talent.orbit_breaker*dot.moonfire.ticking*40" );
def->add_action( "berserking,if=buff.ca_inc.up|fight_remains<15" );
def->add_action( "potion,if=buff.ca_inc.up|fight_remains<25" );
def->add_action( "use_items,slots=trinket1,if=variable.on_use_trinket!=1&!trinket.2.ready_cooldown|(variable.on_use_trinket=1|variable.on_use_trinket=3)&buff.ca_inc.up|fight_remains<20|variable.on_use_trinket=0" );
def->add_action( "use_items,slots=trinket2,if=variable.on_use_trinket!=2&!trinket.1.ready_cooldown|variable.on_use_trinket=2&buff.ca_inc.up|fight_remains<20|variable.on_use_trinket=0" );
def->add_action( "use_items" );
def->add_action( "run_action_list,name=aoe,if=variable.is_aoe" );
def->add_action( "run_action_list,name=st" );

st->add_action( "sunfire,target_if=refreshable&astral_power.deficit>variable.passive_asp+3" );
st->add_action( "moonfire,target_if=refreshable&astral_power.deficit>variable.passive_asp+3" );
st->add_action( "stellar_flare,target_if=refreshable&astral_power.deficit>variable.passive_asp+8" );
st->add_action( "celestial_alignment" );
st->add_action( "incarnation" );
st->add_action( "convoke_the_spirits,if=buff.ca_inc.up" );
st->add_action( "warrior_of_elune" );
st->add_action( "fury_of_elune,if=astral_power.deficit>variable.passive_asp+8" );
st->add_action( "wild_mushroom,if=astral_power.deficit>variable.passive_asp+20" );
st->add_action( "force_of_nature,if=astral_power.deficit>variable.passive_asp+20" );
st->add_action( "astral_communion,if=astral_power.deficit>variable.passive_asp+75" );
st->add_action( "starfire,if=eclipse.any_next|buff.eclipse_solar.remains<action.wrath.execute_time" );
st->add_action( "starfall,if=buff.starweavers_warp.up" );
st->add_action( "starsurge,if=" );
st->add_action( "starfire,if=buff.warrior_of_elune.up&buff.eclipse_lunar.up" );
st->add_action( "wrath" );
st->add_action( "run_action_list,name=fallthru" );

aoe->add_action( "sunfire,target_if=refreshable&astral_power.deficit>variable.passive_asp+3&time_to_die>8" );
aoe->add_action( "moonfire,target_if=refreshable&astral_power.deficit>variable.passive_asp+3&time_to_die>8" );
aoe->add_action( "stellar_flare,target_if=refreshable&astral_power.deficit>variable.passive_asp+8&time_to_die>8" );
aoe->add_action( "celestial_alignment" );
aoe->add_action( "incarnation" );
aoe->add_action( "convoke_the_spirits,if=buff.ca_inc.up" );
aoe->add_action( "warrior_of_elune" );
aoe->add_action( "fury_of_elune,if=astral_power.deficit>variable.passive_asp+8" );
aoe->add_action( "wild_mushroom,if=astral_power.deficit>variable.passive_asp+20" );
aoe->add_action( "force_of_nature,if=astral_power.deficit>variable.passive_asp+20" );
aoe->add_action( "astral_communion,if=astral_power.deficit>variable.passive_asp+75" );
aoe->add_action( "wrath,if=eclipse.any_next|buff.eclipse_lunar.remains<action.wrath.execute_time" );
aoe->add_action( "starfall,if=" );
aoe->add_action( "starsurge,if=buff.starweavers_weft.up" );
aoe->add_action( "starfire" );
aoe->add_action( "run_action_list,name=fallthru" );

fallthru->add_action( "starfall,if=variable.is_aoe" );
fallthru->add_action( "starsurge" );
fallthru->add_action( "sunfire,target_if=dot.moonfire.remains>remains*22%18" );
fallthru->add_action( "moonfire" );
